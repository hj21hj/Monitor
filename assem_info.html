<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì œ22ëŒ€ êµ­íšŒ ì¸ì ì‚¬í•­ ê²€ìƒ‰</title>
    <style>
        :root { --primary: #003478; --accent: #0056b3; --bg: #f8f9fa; --border: #dee2e6; }
        body { font-family: 'Pretendard', sans-serif; background-color: var(--bg); margin: 0; padding: 10px; color: #333; -webkit-tap-highlight-color: transparent; }
        
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        header { border-bottom: 2px solid var(--primary); margin-bottom: 15px; padding-bottom: 10px; }
        h1 { color: var(--primary); font-size: 18px; margin: 0; text-align: center; }

        .search-area { display: flex; flex-direction: column; gap: 8px; margin-bottom: 15px; padding: 12px; background: #f1f3f5; border-radius: 8px; }
        .search-row { display: flex; flex-direction: column; gap: 8px; }
        
        select, input { width: 100% !important; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; font-size: 14px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 15px; }

        .table-wrapper { overflow-x: auto; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        
        @media (min-width: 768px) {
            .search-row { flex-direction: row; }
            button { width: auto; }
            h1 { font-size: 22px; text-align: left; }
            body { padding: 20px; }
        }

        /* ëª¨ë°”ì¼ ì¹´ë“œ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        #memberTableBody tr { 
            display: flex; flex-direction: column; margin-bottom: 15px; 
            border: 1px solid var(--border); border-radius: 8px; background: #fff; padding: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        #memberTableBody td { border: none; padding: 6px 0; display: flex; justify-content: space-between; align-items: center; white-space: normal; }
        #memberTableBody td::before { content: attr(data-label); font-weight: bold; color: #666; font-size: 12px; margin-right: 10px; }
        
        @media (min-width: 768px) {
            #memberTableBody tr { display: table-row; }
            #memberTableBody td { display: table-cell; border-bottom: 1px solid #eee; padding: 10px 12px; }
            #memberTableBody td::before { display: none; }
            thead { display: table-header-group; }
        }
        @media (max-width: 767px) {
            thead { display: none; }
        }

        .name-link { color: var(--primary); font-weight: 700; font-size: 16px; text-decoration: underline; cursor: pointer; }
        .badge { background: #eee; padding: 2px 8px; border-radius: 4px; font-size: 12px; }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); }
        .modal-content { 
            background: white; position: absolute; bottom: 0; width: 100%; 
            border-radius: 20px 20px 0 0; max-height: 85vh; overflow-y: auto; animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        @media (min-width: 768px) {
            .modal-content { position: relative; margin: 50px auto; width: 600px; border-radius: 8px; bottom: auto; }
        }

        .modal-header { background: var(--primary); color: white; padding: 15px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: space-between; align-items: center; }
        .detail-table { width: 100%; border-collapse: collapse; }
        .detail-table th { background: #f8f9fa; width: 35%; padding: 12px; border-bottom: 1px solid var(--border); font-size: 13px; text-align: left; color: #666; }
        .detail-table td { padding: 12px; border-bottom: 1px solid var(--border); font-size: 14px; line-height: 1.5; color: #111; }

        .loading { text-align: center; padding: 30px; font-size: 16px; color: var(--primary); }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ›ï¸ ì œ22ëŒ€ êµ­íšŒ ì¸ì ì‚¬í•­ ê²€ìƒ‰</h1>
    </header>

    <div class="search-area">
        <div class="search-row">
            <select id="committeeSelect" onchange="handleFilter()">
                <option value="">ì „ì²´ ìœ„ì›íšŒ</option>
                <option value="ë¬¸í™”ì²´ìœ¡ê´€ê´‘ìœ„ì›íšŒ">ë¬¸í™”ì²´ìœ¡ê´€ê´‘ìœ„ì›íšŒ</option>
                <option value="ë²•ì œì‚¬ë²•ìœ„ì›íšŒ">ë²•ì œì‚¬ë²•ìœ„ì›íšŒ</option>
                <option value="ì •ë¬´ìœ„ì›íšŒ">ì •ë¬´ìœ„ì›íšŒ</option>
                <option value="ê¸°íšì¬ì •ìœ„ì›íšŒ">ê¸°íšì¬ì •ìœ„ì›íšŒ</option>
                <option value="êµìœ¡ìœ„ì›íšŒ">êµìœ¡ìœ„ì›íšŒ</option>
                <option value="ê³¼í•™ê¸°ìˆ ì •ë³´ë°©ì†¡í†µì‹ ìœ„ì›íšŒ">ê³¼í•™ê¸°ìˆ ì •ë³´ë°©ì†¡í†µì‹ ìœ„ì›íšŒ</option>
                <option value="ì™¸êµí†µì¼ìœ„ì›íšŒ">ì™¸êµí†µì¼ìœ„ì›íšŒ</option>
                <option value="êµ­ë°©ìœ„ì›íšŒ">êµ­ë°©ìœ„ì›íšŒ</option>
                <option value="í–‰ì •ì•ˆì „ìœ„ì›íšŒ">í–‰ì •ì•ˆì „ìœ„ì›íšŒ</option>
                <option value="ë†ë¦¼ì¶•ì‚°ì‹í’ˆí•´ì–‘ìˆ˜ì‚°ìœ„ì›íšŒ">ë†ë¦¼ì¶•ì‚°ì‹í’ˆí•´ì–‘ìˆ˜ì‚°ìœ„ì›íšŒ</option>
                <option value="ì‚°ì—…í†µìƒìì›ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ìœ„ì›íšŒ">ì‚°ì—…í†µìƒìì›ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ìœ„ì›íšŒ</option>
                <option value="ë³´ê±´ë³µì§€ìœ„ì›íšŒ">ë³´ê±´ë³µì§€ìœ„ì›íšŒ</option>
                <option value="í™˜ê²½ë…¸ë™ìœ„ì›íšŒ">í™˜ê²½ë…¸ë™ìœ„ì›íšŒ</option>
                <option value="êµ­í† êµí†µìœ„ì›íšŒ">êµ­í† êµí†µìœ„ì›íšŒ</option>
                <option value="ì •ë³´ìœ„ì›íšŒ">ì •ë³´ìœ„ì›íšŒ</option>
                <option value="ì—¬ì„±ê°€ì¡±ìœ„ì›íšŒ">ì—¬ì„±ê°€ì¡±ìœ„ì›íšŒ</option>
            </select>
            <input type="text" id="unifiedSearch" placeholder="ì´ë¦„, ë³´ì¢Œê´€, ë¹„ì„œê´€ ë“± ê²€ìƒ‰" onkeyup="if(window.event.keyCode==13){handleFilter()}">
            <button onclick="handleFilter()">ê²€ìƒ‰</button>
        </div>
    </div>

    <div id="loading" class="loading" style="display:none;">ğŸ“¡ ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</div>
    
    <div class="table-wrapper">
        <table id="pcTableHead">
            <thead>
                <tr>
                    <th>ì„±ëª…</th>
                    <th>ì •ë‹¹</th>
                    <th>ì„ ê±°êµ¬</th>
                    <th>ì‚¬ë¬´ì‹¤ í˜¸ì‹¤</th>
                    <th>ë³´ì¢Œê´€</th>
                </tr>
            </thead>
            <tbody id="memberTableBody"></tbody>
        </table>
    </div>
</div>

<div id="detailModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <span></span>
            <strong>ì˜ì› ìƒì„¸ ì •ë³´</strong>
            <span onclick="closeModal()" style="cursor:pointer; font-size:24px; padding: 0 10px;">&times;</span>
        </div>
        <table class="detail-table" id="detailContent"></table>
        <div style="padding: 20px; text-align: center; background: #f8f9fa;">
            <button onclick="closeModal()" style="background:#fff; color:var(--primary); border:1px solid var(--primary); width: 120px;">ë‹«ê¸°</button>
        </div>
    </div>
</div>

<script>
    const API_KEY = '4fbc27e65852496ab48087bcb355321a';
    const ENDPOINT = 'https://open.assembly.go.kr/portal/openapi/nwvrqwxyaytdsfvhu';
    let allMembers = [];

    window.onload = () => fetchAllAssemblyData();

    async function fetchAllAssemblyData() {
        const loader = document.getElementById('loading');
        loader.style.display = 'block';
        try {
            const response = await fetch(`${ENDPOINT}?KEY=${API_KEY}&Type=json&pIndex=1&pSize=500`);
            const data = await response.json();
            if (data.nwvrqwxyaytdsfvhu) {
                allMembers = data.nwvrqwxyaytdsfvhu[1].row;
                renderTable(allMembers);
            }
        } catch (error) { 
            console.error(error);
            alert('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨'); 
        } finally { 
            loader.style.display = 'none'; 
        }
    }

    function handleFilter() {
        const committee = document.getElementById('committeeSelect').value;
        const text = document.getElementById('unifiedSearch').value.trim().toLowerCase();
        
        const filtered = allMembers.filter(m => {
            const mComm = !committee || (m.CMITS && m.CMITS.includes(committee));
            const mText = !text || [m.HG_NM, m.STAFF, m.SECRETARY, m.SECRETARY2].some(v => v && v.toLowerCase().includes(text));
            return mComm && mText;
        });
        renderTable(filtered);
    }

    function renderTable(data) {
        const container = document.getElementById('memberTableBody');
        if(data.length === 0) {
            container.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:50px;">ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            return;
        }

        container.innerHTML = data.map(item => `
            <tr>
                <td data-label="ì„±ëª…"><span class="name-link" onclick="openModal('${item.MONA_CD}')">${item.HG_NM}</span></td>
                <td data-label="ì •ë‹¹"><span class="badge">${item.POLY_NM}</span></td>
                <td data-label="ì„ ê±°êµ¬">${item.ORIG_NM}</td>
                <td data-label="ì‚¬ë¬´ì‹¤ í˜¸ì‹¤">${item.ASSEM_ADDR || '-'}</td>
                <td data-label="ë³´ì¢Œê´€" style="font-size:12px; color:#666;">${item.STAFF || '-'}</td>
            </tr>
        `).join('');
    }

    function openModal(monaCd) {
        const item = allMembers.find(m => m.MONA_CD === monaCd);
        if(!item) return;

        const fields = [
            ["í•œìëª…", item.HJ_NM], ["ì •ë‹¹", item.POLY_NM], ["ì„ ê±°êµ¬", item.ORIG_NM],
            ["ì†Œì† ìœ„ì›íšŒ", item.CMITS], ["ìƒë…„ì›”ì¼", item.BTH_DATE], ["ì „í™”ë²ˆí˜¸", item.TEL_NO],
            ["ì‚¬ë¬´ì‹¤ í˜¸ì‹¤", item.ASSEM_ADDR], ["ì´ë©”ì¼", item.E_MAIL], 
            ["í™ˆí˜ì´ì§€", item.HOMEPAGE ? `<a href="${item.HOMEPAGE}" target="_blank" style="color:var(--accent)">ë°”ë¡œê°€ê¸°</a>` : '-'],
            ["ë³´ì¢Œê´€", item.STAFF], ["ì„ ì„ë¹„ì„œê´€", item.SECRETARY], ["ë¹„ì„œê´€", item.SECRETARY2]
        ];
        
        document.getElementById('detailContent').innerHTML = fields.map(f => 
            `<tr><th>${f[0]}</th><td>${f[1] || '-'}</td></tr>`).join('');
        document.getElementById('detailModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        document.getElementById('detailModal').style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    window.onclick = function(event) {
        if (event.target == document.getElementById('detailModal')) closeModal();
    }
</script>
</body>
</html>


